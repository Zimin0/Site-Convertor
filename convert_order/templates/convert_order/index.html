{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <title>{% trans 'SAP XML - Generator Converter' %}</title>
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'convert_order/img/icon.jpg' %}"/> 
    <link rel="stylesheet" href="{% static 'convert_order/css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'convert_order/css/media.css' %}"> 
</head>
</head>

<body>
    <header class="header">
        <div class="container wrapper">
            <a href="{% url 'convert_order:clear_main' %}" class="logo">
                <img src="{% static 'convert_order/img/converter-logo.jpg' %}" alt="">
                <span>SAP XML Converter</span>
            </a>
            <div class="button-container">
                {% if phone_is_confirmed %}
                    <a class="sign_in-btn">Беспл. скачиваний: {{ amount_of_convertations }}</a> 
                {% else %}
                    <a href="{% url 'users:login' %}" class="sign_in-btn">Вход</a>
                    <a href="{% url 'users:register' %}" class="sign_in-btn">Регистрация</a>
                {% endif %}
                <!-- Lang Btn -->
                <select class="lang-btn">
                    <option value="RU">RU</option>
                    <option value="ENG">ENG</option>
                </select>
                <!-- End Lang Btn -->
            </div>
        </div>
    </header>

    <section class="converter">

        <div class="container">
            <div class="wrapper title-info">
                <p class="subtitle">
                    Этот сервис помогает перенести настройки Ваших отчетов, настроенных SAP XML-Generator, в
                    отчеты новых версий, в случае когда появляются новые форматы отчетов (в виде схем XSD). В результате
                    Вы получите XML-файл «нового» формата с перенесенными в него настройками.
                </p>
                <p class="subtitle">
                    {{ message|default:"Для переноса настроек из старого формата в новый формат Вам необходимо загрузить на сервис:  1.XML-файл «старой» структуры с настроенными правилами формирования тегов (FILE_IN1).  2.XML-Файл «новой» структуры, в который необходимо перенести настойки (FILE_IN2)." }}
                </p>
            </div>

            <form method="POST" id="file-form" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="dropfile-area">
                    <label class="file-field" id="file-field-1">
                        <input type="file" name="file1" id="file_1">
                        <div id="file1"> <!--  !!!!!!!!!!!!!  -->  
                            <a href="{% url 'convert_order:video' 1 %}" ><img id="cloud_quest-1" src="{% static 'convert_order/img/cloud_question_icon.svg' %}" 
                                    alt="?" onmouseenter="showPopup1()" onmouseleave="hidePopup1()"></a>

                            <img id="add-file-1" src="{% static 'convert_order/img/icons8-плюс.svg' %}" alt="Add file">
                            <p id="add-file-title-1">XML-файл «старой» структуры</p>
                        </div>
                    </label>

                    <label class="file-field" id="file-field-2">
                        <input type="file" name="file2" id="file_2">
                        <div id="file2">  <!--  !!!!!!!!!!!!!  --> 
                            <a href="{% url 'convert_order:video' 2 %}" ><img id="cloud_quest-2" src="{% static 'convert_order/img/cloud_question_icon.svg' %}" 
                                    alt="?" onmouseenter="showPopup2()" onmouseleave="hidePopup2()"></a>

                            <img id="add-file-2" src="{% static 'convert_order/img/icons8-плюс.svg' %}" alt="Add file">
                            <p id="add-file-title-2">XML-Файл «новой» структуры</p>
                        </div>
                    </label>
                </div>

                <div class="converter-container">
                    <img id="up-arrow" src="{% static 'convert_order/img/converter-arrow.svg' %}" alt="">

                    <div id="popup-info-1">
                        Как получить XML-файл «старой» структуры: <br>
                        1.Зайти в иерархию «старой» структуры в SAP XML-Генератор <br>
                        2. Экспортировать в XML-файл.
                    </div>

                    <input type="submit" id="converter-btn" value="Конвертировать">
                    
                    {% if files_uploaded %}
                    <script> // Выключаем кнопку
                        const converterBtn1 = document.getElementById('converter-btn');
                        converterBtn1.setAttribute('disabled', '');
                    </script>
                    {% endif %}

                    <img id="down-arrow" src="{% static 'convert_order/img/converter-arrow.svg' %}" alt="">

                    <div id="popup-info-2">
                        Как получить XML файл «новой» структуры: <br>
                        1. Получить XSD-схему нового формата <br>
                        2. Импортировать XSD-схему в SAP XML-Generator <br>
                        3. Экспортировать в XML-файл.
                    </div>
                </div>

                <div class="download-container">
                    <img id="right-arrow" src="{% static 'convert_order/img/download-arrow.png' %}" alt="">
                    {% if files_uploaded %} 
                        {% if phone_is_confirmed %}
                            {% if amount_of_convertations < 1 %}
                                <input type="button" id="download-btn" value="Скачать" onclick="location.href='{% url 'users:need_to_pay' %}';">
                            {% else %}
                                <input type="button" id="download-btn" value="Скачать" onclick="location.href='{% url 'files:load_file' order_id %}'; setTimeout(function(){window.location.href='/';}, 500);">
                            {% endif %}
                        {% else %}
                            <input type="button" id="download-btn" value="Скачать" onclick="location.href='{% url 'users:register' %}';">
                        {% endif %}
                    {% else %}
                        <input type="submit" id="download-btn" value="Скачать" disabled>
                    {% endif %}

                    {% if files_uploaded %}
                     <script>
                        const upArrow = document.getElementById('up-arrow');
                        upArrow.style.transition = 'opacity 10s ease-in';
                        upArrow.style.opacity = 1;
                        const downArrow = document.getElementById('down-arrow');
                        downArrow.style.transition = 'opacity 10s ease-in';
                        downArrow.style.opacity = 1;
                        const rightArrow = document.getElementById('right-arrow');
                        rightArrow.style.transition = 'opacity 10s ease-in';
                        rightArrow.style.opacity = 1;
                    </script> 
                    {% endif %}
                        
                </div>
            </form>
        </div>

        <div class="info-block container wrapper">
            <div class="info">
                <p>
                    ООО "Название компании" <br>
                    <phone>+7-917-578-67-06</phone>
                </p>
            </div>
            <div class="info">
                <p>
                    Мы помогаем Вам сделать жизнь чуточку проще!
                </p>

                <div class="sup-btn-conteiner">
                    <a href="{% url 'support:support' %}" class="support-btn">Поддержка</a> 
                    <a href="{% url 'convert_order:info' %}" class="support-btn">О конвертере</a> 
                </div>

            </div>
        </div>

        {% if not cookies_is_confirmed %}
        <div id="cookie-popup">
            <div class="wrapper">
                <p class="cookie-text">Этот сайт использует файлы cookies! Продолжая использовать наш сайт, Вы
                    автоматически
                    соглашаетесь с их использованием</p>
                <img src="{% static 'convert_order/img/cookie-icon.svg' %}" alt="" id="cookie-icon"> 
            </div>
            <button class="confirm-btn" id="cookie-confirm" onclick="closeCookies()">Согласиться</button>
        </div>
        {% endif %}

    </section>

    <footer class="footer">
        <p class="footer-copyright">© Copyright 2023. Все права защищены</p>
    </footer>

    <script src="{% static 'convert_order/js/file-form.js' %}"></script>
</body>

</html>